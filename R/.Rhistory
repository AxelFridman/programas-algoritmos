modPrecioFon[i] = fon
modPrecioSupCub[i] = sup
modPrecioSupyFondo[i] = fonSup
}
errorModeloSup = c()
errorModeloFon = c()
errorModeloSupFon = c()
for(i in 1:gradoMax){
errorDeEsteModeloParticularSup = c() #Suavizados los modelos
errorDeEsteModeloParticularFon = c()
errorDeEsteModeloParticularSupFon = c()
for(j in 1:10){
errorDeEsteModeloParticularSup[j] = crossval(df,modPrecioSupCub[i], 1, PMAE, 20)[[2]]
errorDeEsteModeloParticularFon[j] = crossval(df,modPrecioFon[i], 1, PMAE, 20)[[2]]
errorDeEsteModeloParticularSupFon[j] = crossval(df,modPrecioSupyFondo[i], 1, PMAE, 20)[[2]]
}
errorModeloSup[i] = mean(errorDeEsteModeloParticularSup)
errorModeloFon[i] = mean(errorDeEsteModeloParticularFon)
errorModeloSupFon[i] = mean(errorDeEsteModeloParticularSupFon)
}
plot(1:gradoMax, errorModeloSup, col="magenta", ylim=range(errorModeloSup, errorModeloFon, errorModeloSupFon), pch=19, xlab = "Grado del modelo", ylab = "Error (PMAE) de cada modelo")
points(1:gradoMax, errorModeloFon, col="red",pch=19)
points(1:gradoMax, errorModeloSupFon, col="blue",pch=19)
lines(1:gradoMax, errorModeloSup, col="magenta", lty="dotted")
lines(1:gradoMax, errorModeloFon, col="red", lty="dotted")
lines(1:gradoMax, errorModeloSupFon, col="blue", lty="dotted")
legend(x="right", legend = c("Sup","Fon", "Sup+Fon"), pch = c(19,19,19), lty = "dotted", col = c("magenta", "red", "blue"))
modelosPosibles = c(formula('price~surface_covered'),
formula('price~fondo'),
formula('price~property_type'),
formula('price~lat+lon'),
formula('price~surface_covered+fondo'),
formula('price~surface_covered+property_type'),
formula('price~surface_covered+lat+lon'),
formula('price~fondo+property_type'),
formula('price~fondo+lat+lon'),
formula('price~property_type+lat+lon'),
formula('price~fondo+property_type+lat+lon'),
formula('price~surface_covered+property_type+lat+lon'),
formula('price~surface_covered+fondo+property_type'),
formula('price~surface_covered+fondo+lat+lon'),
formula('price~surface_covered+fondo+property_type+lat+lon')
)
indices = (df2$l1 == "Argentina" &
df2$l2 == "Capital Federal" &
df2$price != 0 &
df2$operation_type == "Alquiler" &
! is.na(df2$l3) &
! is.na(df2$lat) &
! is.na(df2$lon) &
! is.na(df2$property_type) &
! is.na(df2$surface_covered) &
! is.na(df2$price) &
! is.na(df2$surface_total)
)
dfCasas = df2[df2$property_type=="Casa" & indices,]
dfCasas$fondo = dfCasas$surface_total - dfCasas$surface_covered
dfPH = df2[df2$property_type=="PH" & indices,]
dfPH$fondo = dfPH$surface_total - dfPH$surface_covered
df = df[ , -which(names(df) %in% c("X"))]
dfPH = dfPH[,colnames(df)]
dfCasas = dfCasas[,colnames(df)]
df = rbind(df, dfPH[sample(nrow(dfPH), 97), ])
df = rbind(df, dfCasas[sample(nrow(dfCasas), 97), ])
errorModelos = c()
errorNaiveModelos = c()
for(i in 1:length(modelosPosibles)){
errorDeEsteModeloParticular = c() #Suavizados los modelos
for(j in 1:5){
errorDeEsteModeloParticular[j] = crossval(df,modelosPosibles[[i]], 10, PMAE, 58)[[2]]
}
errorModelos[i] = mean(errorDeEsteModeloParticular)
errorNaiveModelos[i] = PMAE(df$price,predict(lm(modelosPosibles[[i]], data=df), df))
}
names(errorModelos) = gsub("price", "", as.character(modelosPosibles))
par(mar=c(15, 3, 3, 1))
barplot(sort(errorModelos, decreasing = T), main="Validacion Cruzada errores", las=2, cex.names = 0.7,
names.arg=names(sort(errorModelos, decreasing = T)))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores")
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
#lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores")
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
#lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errorModelos = c()
errorNaiveModelos = c()
for(i in 1:length(modelosPosibles)){
errorDeEsteModeloParticular = c() #Suavizados los modelos
for(j in 1:5){
errorDeEsteModeloParticular[j] = crossval(df,modelosPosibles[[i]], 10, PMAE, 58)[[2]]
}
errorModelos[i] = mean(errorDeEsteModeloParticular)
errorNaiveModelos[i] = PMAE(df$price,predict(lm(modelosPosibles[[i]], data=df), df))
}
names(errorModelos) = gsub("price", "", as.character(modelosPosibles))
par(mar=c(15, 3, 3, 1))
barplot(sort(errorModelos, decreasing = T), main="Validacion Cruzada errores", las=2, cex.names = 0.7,
names.arg=names(sort(errorModelos, decreasing = T)))
errorModelos = c()
errorNaiveModelos = c()
for(i in 1:length(modelosPosibles)){
errorDeEsteModeloParticular = c() #Suavizados los modelos
for(j in 1:5){
errorDeEsteModeloParticular[j] = crossval(df,modelosPosibles[[i]], 10, PMAE, 58)[[2]]
}
errorModelos[i] = mean(errorDeEsteModeloParticular)
errorNaiveModelos[i] = PMAE(df$price,predict(lm(modelosPosibles[[i]], data=df), df))
}
names(errorModelos) = gsub("price", "", as.character(modelosPosibles))
par(mar=c(15, 3, 3, 1))
barplot(sort(errorModelos, decreasing = T), main="Validacion Cruzada errores", las=2, cex.names = 0.7,
names.arg=names(sort(errorModelos, decreasing = T)))
errorModelos = c()
errorNaiveModelos = c()
for(i in 1:length(modelosPosibles)){
errorDeEsteModeloParticular = c() #Suavizados los modelos
for(j in 1:5){
errorDeEsteModeloParticular[j] = crossval(df,modelosPosibles[[i]], 10, PMAE, 58)[[2]]
}
errorModelos[i] = mean(errorDeEsteModeloParticular)
errorNaiveModelos[i] = PMAE(df$price,predict(lm(modelosPosibles[[i]], data=df), df))
}
names(errorModelos) = gsub("price", "", as.character(modelosPosibles))
par(mar=c(15, 3, 3, 1))
barplot(sort(errorModelos, decreasing = T), main="Validacion Cruzada errores", las=2, cex.names = 0.7,
names.arg=names(sort(errorModelos, decreasing = T)))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
#par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores")
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
#lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
#dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores")
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
#lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores")
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
#lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
#lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="l")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
#lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="l")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
#lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
#segments(x0 = c(1:length(errorNaiveModelos)),
#         y0 = errores$cruzada,
#         x1 = c(1:length(errorNaiveModelos)),
#         y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
#lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
lines(errorModelos[1], errorNaiveModelos[1], col="magenta", lty="dotted")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
lines(errorModelos[1], errorNaiveModelos[1], col="magenta")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=errores$modelo, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
lines(errorModelos[1], errorNaiveModelos[1], col="magenta")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=1:15, las=2)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
lines(errorModelos[1], errorNaiveModelos[1], col="magenta")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=1:15, las=1)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
lines(errorModelos[1], errorNaiveModelos[1], col="magenta")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=1:15, las=1)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
errores$modelo
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "", ylab= "Errores", type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
lines(errorModelos[1], errorNaiveModelos[1], col="magenta")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=1:15, las=1)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
print(errores$modelo)
errorModelos = c()
errorNaiveModelos = c()
for(i in 1:length(modelosPosibles)){
errorDeEsteModeloParticular = c() #Suavizados los modelos
for(j in 1:5){
errorDeEsteModeloParticular[j] = crossval(df,modelosPosibles[[i]], 10, PMAE, 58)[[2]]
}
errorModelos[i] = mean(errorDeEsteModeloParticular)
errorNaiveModelos[i] = PMAE(df$price,predict(lm(modelosPosibles[[i]], data=df), df))
}
names(errorModelos) = gsub("price", "", as.character(modelosPosibles))
par(mar=c(15, 3, 3, 1))
barplot(sort(errorModelos, decreasing = T), main="Validacion Cruzada errores", las=2, cex.names = 0.7,
names.arg=names(sort(errorModelos, decreasing = T)), xlab = "Modelos", ylab = "Error PMAE")
errorModelos = c()
errorNaiveModelos = c()
for(i in 1:length(modelosPosibles)){
errorDeEsteModeloParticular = c() #Suavizados los modelos
for(j in 1:5){
errorDeEsteModeloParticular[j] = crossval(df,modelosPosibles[[i]], 10, PMAE, 58)[[2]]
}
errorModelos[i] = mean(errorDeEsteModeloParticular)
errorNaiveModelos[i] = PMAE(df$price,predict(lm(modelosPosibles[[i]], data=df), df))
}
names(errorModelos) = gsub("price", "", as.character(modelosPosibles))
par(mar=c(15, 3, 3, 1))
barplot(sort(errorModelos, decreasing = T), main="Validacion Cruzada errores", las=2, cex.names = 0.7,
names.arg=names(sort(errorModelos, decreasing = T)), xlab = "Modelos", ylab = "Error PMAE")
errorModelos = c()
errorNaiveModelos = c()
for(i in 1:length(modelosPosibles)){
errorDeEsteModeloParticular = c() #Suavizados los modelos
for(j in 1:5){
errorDeEsteModeloParticular[j] = crossval(df,modelosPosibles[[i]], 10, PMAE, 58)[[2]]
}
errorModelos[i] = mean(errorDeEsteModeloParticular)
errorNaiveModelos[i] = PMAE(df$price,predict(lm(modelosPosibles[[i]], data=df), df))
}
names(errorModelos) = gsub("price", "", as.character(modelosPosibles))
par(mar=c(15, 3, 3, 1))
barplot(sort(errorModelos, decreasing = T), main="Validacion Cruzada errores", las=2, cex.names = 0.7,
names.arg=names(sort(errorModelos, decreasing = T)), xlab = "", ylab = "Error PMAE")
98*3
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "Modelos", ylab= "Errores", xlab= "Modelo nro" ,type="b")
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "Modelos", ylab= "Errores" ,type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
lines(errorModelos[1], errorNaiveModelos[1], col="magenta")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=1:15, las=1)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
print(errores$modelo)
errorModelos = c()
errorNaiveModelos = c()
for(i in 1:length(modelosPosibles)){
errorDeEsteModeloParticular = c() #Suavizados los modelos
for(j in 1:5){
errorDeEsteModeloParticular[j] = crossval(df,modelosPosibles[[i]], 10, PMAE, 58)[[2]]
}
errorModelos[i] = mean(errorDeEsteModeloParticular)
errorNaiveModelos[i] = PMAE(df$price,predict(lm(modelosPosibles[[i]], data=df), df))
}
names(errorModelos) = gsub("price", "", as.character(modelosPosibles))
par(mar=c(15, 3, 3, 1))
barplot(sort(errorModelos, decreasing = T), main="Validacion Cruzada errores", las=2, cex.names = 0.7,
names.arg=names(sort(errorModelos, decreasing = T)), xlab = "", ylab = "Error PMAE")
errorModelos = c()
errorNaiveModelos = c()
for(i in 1:length(modelosPosibles)){
errorDeEsteModeloParticular = c() #Suavizados los modelos
for(j in 1:5){
errorDeEsteModeloParticular[j] = crossval(df,modelosPosibles[[i]], 10, PMAE, 58)[[2]]
}
errorModelos[i] = mean(errorDeEsteModeloParticular)
errorNaiveModelos[i] = PMAE(df$price,predict(lm(modelosPosibles[[i]], data=df), df))
}
names(errorModelos) = gsub("price", "", as.character(modelosPosibles))
par(mar=c(15, 3, 3, 1))
barplot(sort(errorModelos, decreasing = T), main="Validacion Cruzada errores", las=2, cex.names = 0.7,
names.arg=names(sort(errorModelos, decreasing = T)), xlab = "", ylab = "Error PMAE")
errores = data.frame(1:15)
errores$cruzada = errorModelos
errores$naive = errorNaiveModelos
errores$modelo = names(errorModelos)
errores = errores[order(errores$cruzada, decreasing = T),]
par(mar=c(16, 3, 3, 1))
dev.new(width=5, height=25, unit="cm")
plot(c(1:length(errorModelos)), errores$cruzada, col="magenta", ylim=range(0,errorNaiveModelos, errorModelos,1),pch=19, xlab = "Modelo nro", ylab= "Errores" ,type="b")
lines(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
points(c(1:length(errorNaiveModelos)), errores$naive, col="green",pch=19)
lines(errorModelos[1], errorNaiveModelos[1], col="magenta")
segments(x0 = c(1:length(errorNaiveModelos)),
y0 = errores$cruzada,
x1 = c(1:length(errorNaiveModelos)),
y1 = errores$naive)
axis(1, at=1:length(errorModelos), labels=1:15, las=1)
legend(x="top" ,legend = c("Error cruzado","Error naive"), pch = c(19,19), col = c("magenta", "green"))
print(errores$modelo)
df = read.csv("datos_alquiler_crossvalidation.csv", stringsAsFactors = F)
df2 = read.csv("ar_properties.csv", stringsAsFactors = F)
crossval
c(1,2,3)*c(4,2,-1)
c(1,2,3)*c(4,2)
c(1,2,3)*c(4,2,5,6,7,1)
c(4,2,5,6,7,1)*c(1,2,3)
c(4,2,5,6,7,1)*c(1,2,3)**2
c(4,2,5,6,7,1)*c(1,2,3)**9
c(4,2,5,6,7,1)*c(1,2,3)**19
x
y
plot(x,y)
